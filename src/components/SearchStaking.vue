<template>
<div class="staking-wrapper">
	<h4 class="text-headline mx-auto max-w-fit">
		{{total_staked}}N Staked by
	</h4>
	<h4 class="text-headline mx-auto max-w-fit">
		{{total_stakers}} Stakers at the top
	</h4>
	<h4 class="text-headline mx-auto max-w-fit">
		{{total_pools}} pools
	</h4>
	<span class="zavodil-tag mt-8">
		data provided by
		<a href="https://near.zavodil.ru/" class="link">Zavodil</a>
	</span>
</div>
</template>

<script>
export default {
	name: 'SearchStaking',
	data() {
		return {
			updating_pools: false,
			total_staked: 0,
			total_stakers: 0,
			total_pools: 0,
			staking_pools: []
		}
	},
	mounted() {
	 this.updateStakingPools()
	},
	methods: {
		async updateStakingPools() {
			try {
				this.updating_pools = true
				// let result = await fetch('https://near.zavodil.ru/pools_all.txt', {
				// 	mode: 'cors'
				// })
				// console.log('updateStakingPools result', result)
				let result = {"data":[{"account_id":"staked.poolv1.near","numerator":10,"number_of_accounts":1835,"stake":42990990.880999997,"vote":1,"status":1},{"account_id":"bzam6yjpnfnxsdmjf6pw.poolv1.near","numerator":100,"number_of_accounts":283,"stake":23361069.816399999,"vote":0,"status":1},{"account_id":"aurora.pool.near","numerator":99,"number_of_accounts":2540,"stake":21570101.2568,"vote":0,"status":1},{"account_id":"astro-stakers.poolv1.near","numerator":1,"number_of_accounts":5020,"stake":20618109.8193,"vote":1,"status":1},{"account_id":"bisontrails.poolv1.near","numerator":10,"number_of_accounts":764,"stake":20463643.3323,"vote":1,"status":1},{"account_id":"dragonfly.poolv1.near","numerator":10,"number_of_accounts":337,"stake":19630970.306699999,"vote":0,"status":1},{"account_id":"foundry.poolv1.near","numerator":10,"number_of_accounts":233,"stake":18826296.204999998,"vote":0,"status":1},{"account_id":"finoa.poolv1.near","numerator":10,"number_of_accounts":249,"stake":13743538.2448,"vote":0,"status":1},{"account_id":"blockdaemon.poolv1.near","numerator":5,"number_of_accounts":300,"stake":12547902.6897,"vote":0,"status":1},{"account_id":"epic.poolv1.near","numerator":1,"number_of_accounts":2928,"stake":11451920.897399999,"vote":0,"status":1},{"account_id":"magic.poolv1.near","numerator":5,"number_of_accounts":528,"stake":10488627.530099999,"vote":0,"status":1},{"account_id":"rekt.poolv1.near","numerator":1.5,"number_of_accounts":910,"stake":8952538.6992000006,"vote":0,"status":1},{"account_id":"electric.poolv1.near","numerator":10,"number_of_accounts":196,"stake":8098702.2302999999,"vote":0,"status":1},{"account_id":"zavodil.poolv1.near","numerator":1,"number_of_accounts":4230,"stake":7994924.3989000004,"vote":1,"status":1},{"account_id":"d1.poolv1.near","numerator":5,"number_of_accounts":375,"stake":7258085.8892999999,"vote":0,"status":1},{"account_id":"nearcrowd.poolv1.near","numerator":100,"number_of_accounts":247,"stake":7080118.1388999997,"vote":0,"status":1},{"account_id":"anonymous.poolv1.near","numerator":100,"number_of_accounts":195,"stake":6258501.2251000004,"vote":0,"status":1},{"account_id":"08investinwomen_runbybisontrails.poolv1.near","numerator":5,"number_of_accounts":347,"stake":5854398.2231000001,"vote":0,"status":1},{"account_id":"dokiacapital.poolv1.near","numerator":10,"number_of_accounts":277,"stake":5842709.5284000002,"vote":1,"status":1},{"account_id":"continue.poolv1.near","numerator":5,"number_of_accounts":334,"stake":5386167.3202999998,"vote":0,"status":1},{"account_id":"legends.poolv1.near","numerator":10,"number_of_accounts":334,"stake":5371449.9253000002,"vote":0,"status":1},{"account_id":"accomplice.poolv1.near","numerator":100,"number_of_accounts":211,"stake":5257264.6715000002,"vote":0,"status":1},{"account_id":"chorusone.poolv1.near","numerator":8,"number_of_accounts":396,"stake":5242430.3602999998,"vote":1,"status":1},{"account_id":"abl_pool.poolv1.near","numerator":12,"number_of_accounts":165,"stake":5191684.5321000004,"vote":0,"status":1},{"account_id":"future_is_near.poolv1.near","numerator":3,"number_of_accounts":258,"stake":5161241.2131000003,"vote":0,"status":1},{"account_id":"binancenode1.poolv1.near","numerator":5,"number_of_accounts":273,"stake":5078295.2396,"vote":0,"status":1},{"account_id":"hb436_pool.poolv1.near","numerator":10,"number_of_accounts":139,"stake":4865713.6634,"vote":0,"status":1},{"account_id":"openshards.poolv1.near","numerator":5,"number_of_accounts":1669,"stake":4748516.8408000004,"vote":1,"status":1},{"account_id":"figment.poolv1.near","numerator":10,"number_of_accounts":323,"stake":4658572.2927000001,"vote":0,"status":1},{"account_id":"ideocolabventures.poolv1.near","numerator":10,"number_of_accounts":161,"stake":4419598.8726000004,"vote":0,"status":1},{"account_id":"buildlinks.poolv1.near","numerator":5,"number_of_accounts":1307,"stake":4349769.6743999999,"vote":1,"status":1},{"account_id":"northernlights.poolv1.near","numerator":8,"number_of_accounts":182,"stake":4348025.9598000003,"vote":0,"status":1},{"account_id":"nc2.poolv1.near","numerator":100,"number_of_accounts":168,"stake":4094723.3484,"vote":0,"status":1},{"account_id":"nearfans.poolv1.near","numerator":5,"number_of_accounts":409,"stake":3816791.2527000001,"vote":0,"status":1},{"account_id":"stakin.poolv1.near","numerator":1,"number_of_accounts":2324,"stake":3812835.5211999998,"vote":1,"status":1},{"account_id":"smart-stake.poolv1.near","numerator":1,"number_of_accounts":1923,"stake":3712908.5049000001,"vote":0,"status":1},{"account_id":"nodeasy.poolv1.near","numerator":3,"number_of_accounts":481,"stake":3529308.6334000002,"vote":1,"status":1},{"account_id":"erm.poolv1.near","numerator":8,"number_of_accounts":160,"stake":3528133.3495,"vote":1,"status":1},{"account_id":"cryptium.poolv1.near","numerator":5,"number_of_accounts":332,"stake":3459354.5282999999,"vote":0,"status":1},{"account_id":"lux.poolv1.near","numerator":5,"number_of_accounts":313,"stake":3293790.5216999999,"vote":1,"status":1},{"account_id":"sharpdarts.poolv1.near","numerator":5,"number_of_accounts":369,"stake":3150971.7481999998,"vote":0,"status":1},{"account_id":"hashquark.poolv1.near","numerator":3,"number_of_accounts":558,"stake":3117311.8752000001,"vote":1,"status":1},{"account_id":"everstake.poolv1.near","numerator":3,"number_of_accounts":1936,"stake":3095881.5603,"vote":0,"status":1},{"account_id":"dsrvlabs.poolv1.near","numerator":10,"number_of_accounts":190,"stake":3064968.2659,"vote":1,"status":1},{"account_id":"baziliknear.poolv1.near","numerator":3,"number_of_accounts":416,"stake":2942269.7003000001,"vote":1,"status":1},{"account_id":"stakesabai.poolv1.near","numerator":1,"number_of_accounts":1897,"stake":2864847.8396000001,"vote":1,"status":1},{"account_id":"stardust.poolv1.near","numerator":5,"number_of_accounts":437,"stake":2820328.3766999999,"vote":1,"status":1},{"account_id":"masternode24.poolv1.near","numerator":1,"number_of_accounts":1851,"stake":2798152.1749999998,"vote":1,"status":1},{"account_id":"lunanova.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":257,"stake":2778607.5474999999,"vote":1,"status":1},{"account_id":"appload.poolv1.near","numerator":3,"number_of_accounts":1052,"stake":2476453.0992999999,"vote":0,"status":1},{"account_id":"01node.poolv1.near","numerator":3,"number_of_accounts":1861,"stake":2268669.0460999999,"vote":1,"status":1},{"account_id":"fish.poolv1.near","numerator":4,"number_of_accounts":586,"stake":2100006.372,"vote":0,"status":1},{"account_id":"tottenham_hotspur.poolv1.near","numerator":10,"number_of_accounts":132,"stake":2074525.1244999999,"vote":0,"status":1},{"account_id":"moonlet.poolv1.near","numerator":5,"number_of_accounts":1077,"stake":2032642.7631999999,"vote":1,"status":1},{"account_id":"jazza.poolv1.near","numerator":4,"number_of_accounts":319,"stake":1809282.9242,"vote":1,"status":1},{"account_id":"inotel.poolv1.near","numerator":3,"number_of_accounts":440,"stake":1738988.7775999999,"vote":1,"status":1},{"account_id":"fresh.poolv1.near","numerator":1.8999999999999999,"number_of_accounts":852,"stake":1312112.9175,"vote":1,"status":1},{"account_id":"zkv_staketosupportprivacy.poolv1.near","numerator":4,"number_of_accounts":313,"stake":1088614.3208000001,"vote":0,"status":1},{"account_id":"steak.poolv1.near","numerator":4,"number_of_accounts":133,"stake":715052.19030000002,"vote":0,"status":1},{"account_id":"qbit.poolv1.near","numerator":5,"number_of_accounts":38,"stake":554691.65639999998,"vote":0,"status":1},{"account_id":"lionstake.poolv1.near","numerator":5,"number_of_accounts":66,"stake":453184.92190000002,"vote":0,"status":1},{"account_id":"p2p-org.poolv1.near","numerator":0,"number_of_accounts":688,"stake":429997.34399999998,"vote":0,"status":1},{"account_id":"galaxydigital.poolv1.near","numerator":10,"number_of_accounts":99,"stake":411794.0025,"vote":0,"status":1},{"account_id":"kosmos_and_p2p.poolv1.near","numerator":5,"number_of_accounts":16,"stake":373209.43300000002,"vote":0,"status":1},{"account_id":"ashert.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":19,"stake":369538.52990000002,"vote":0,"status":1},{"account_id":"vortex_live.poolv1.near","numerator":5,"number_of_accounts":46,"stake":360060.86940000003,"vote":0,"status":1},{"account_id":"centurion.poolv1.near","numerator":1,"number_of_accounts":191,"stake":313702.58929999999,"vote":0,"status":1},{"account_id":"sparkpool.poolv1.near","numerator":5,"number_of_accounts":288,"stake":303509.33000000002,"vote":1,"status":1},{"account_id":"binancestaking.poolv1.near","numerator":10,"number_of_accounts":949,"stake":247800.45009999999,"vote":0,"status":1},{"account_id":"optimusvalidatornetwork.poolv1.near","numerator":1,"number_of_accounts":189,"stake":244848.3867,"vote":0,"status":1},{"account_id":"near-fans.poolv1.near","numerator":3,"number_of_accounts":233,"stake":213210.09239999999,"vote":0,"status":1},{"account_id":"dexagon.poolv1.near","numerator":1,"number_of_accounts":197,"stake":199201.42619999999,"vote":0,"status":1},{"account_id":"pathrocknetwork.poolv1.near","numerator":1,"number_of_accounts":188,"stake":193695.88570000001,"vote":0,"status":1},{"account_id":"prophet.poolv1.near","numerator":0,"number_of_accounts":840,"stake":191703.90400000001,"vote":0,"status":1},{"account_id":"cryptogarik.poolv1.near","numerator":1,"number_of_accounts":193,"stake":188794.30220000001,"vote":0,"status":1},{"account_id":"ib.poolv1.near","numerator":3,"number_of_accounts":154,"stake":187042.69760000001,"vote":0,"status":1},{"account_id":"infiniteloop.poolv1.near","numerator":1,"number_of_accounts":159,"stake":181379.21539999999,"vote":0,"status":1},{"account_id":"ledgerbyfigment.poolv1.near","numerator":7.5,"number_of_accounts":22,"stake":173988.4504,"vote":0,"status":1},{"account_id":"pandateam.poolv1.near","numerator":1,"number_of_accounts":186,"stake":171594.7341,"vote":0,"status":1},{"account_id":"stakely_io.poolv1.near","numerator":5,"number_of_accounts":86,"stake":169065.54860000001,"vote":0,"status":1},{"account_id":"staking-power.poolv1.near","numerator":5,"number_of_accounts":44,"stake":166048.75080000001,"vote":0,"status":1},{"account_id":"galactic.poolv1.near","numerator":10,"number_of_accounts":45,"stake":156442.17329999999,"vote":0,"status":1},{"account_id":"incrypted.poolv1.near","numerator":3,"number_of_accounts":217,"stake":155313.40520000001,"vote":0,"status":1},{"account_id":"avado.poolv1.near","numerator":5,"number_of_accounts":28,"stake":152224.66680000001,"vote":0,"status":1},{"account_id":"genesislab.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":33,"stake":151690.8743,"vote":0,"status":1},{"account_id":"shardlabs.poolv1.near","numerator":5,"number_of_accounts":96,"stake":149345.78570000001,"vote":0,"status":1},{"account_id":"grassets.poolv1.near","numerator":5,"number_of_accounts":43,"stake":149046.4247,"vote":0,"status":1},{"account_id":"doubletop.poolv1.near","numerator":3,"number_of_accounts":511,"stake":142848.91810000001,"vote":0,"status":1},{"account_id":"inc4.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":27,"stake":142495.80350000001,"vote":0,"status":1},{"account_id":"lavenderfive.poolv1.near","numerator":5,"number_of_accounts":40,"stake":142219.66440000001,"vote":0,"status":1},{"account_id":"sicmundus.poolv1.near","numerator":5,"number_of_accounts":62,"stake":141231.09169999999,"vote":0,"status":1},{"account_id":"cryptoblossom.poolv1.near","numerator":1,"number_of_accounts":85,"stake":140877.6661,"vote":0,"status":1},{"account_id":"stakesstone.poolv1.near","numerator":5,"number_of_accounts":39,"stake":140779.4333,"vote":0,"status":1},{"account_id":"4ire.poolv1.near","numerator":5,"number_of_accounts":29,"stake":139373.8609,"vote":0,"status":1},{"account_id":"dariya.poolv1.near","numerator":5,"number_of_accounts":29,"stake":136985.7997,"vote":0,"status":1},{"account_id":"anchikovproduction.poolv1.near","numerator":5,"number_of_accounts":25,"stake":129740.0456,"vote":0,"status":1},{"account_id":"bflame.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":12,"stake":107290.6109,"vote":0,"status":1},{"account_id":"projecttent.poolv1.near","numerator":5,"number_of_accounts":28,"stake":104358.3655,"vote":0,"status":1},{"account_id":"ni.poolv1.near","numerator":4,"number_of_accounts":18,"stake":103416.91989999999,"vote":0,"status":1},{"account_id":"chelovek_iz_naroda.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":13,"stake":103306.7049,"vote":0,"status":1},{"account_id":"aurora.poolv1.near","numerator":9,"number_of_accounts":10944,"stake":1805395.7337,"vote":"0","status":0},{"account_id":"n0ok.poolv1.near","numerator":7,"number_of_accounts":11,"stake":103142.30869999999,"vote":"0","status":0},{"account_id":"stakedao_retail.poolv1.near","numerator":7,"number_of_accounts":16,"stake":102243.3631,"vote":"0","status":0},{"account_id":"guli.poolv1.near","numerator":5,"number_of_accounts":10,"stake":100973.06080000001,"vote":"0","status":0},{"account_id":"infstones.poolv1.near","numerator":5,"number_of_accounts":5,"stake":100033.7043,"vote":"0","status":0},{"account_id":"cryptotribe.poolv1.near","numerator":1,"number_of_accounts":151,"stake":40941.483800000002,"vote":"0","status":0},{"account_id":"certusone.poolv1.near","numerator":10,"number_of_accounts":17,"stake":13965.840399999999,"vote":"0","status":0},{"account_id":"audit_one.poolv1.near","numerator":7,"number_of_accounts":234,"stake":12140.5,"vote":"0","status":0},{"account_id":"alex.poolv1.near","numerator":1,"number_of_accounts":12,"stake":1399.7718,"vote":"0","status":0},{"account_id":"near8888.poolv1.near","numerator":5,"number_of_accounts":16,"stake":652.90970000000004,"vote":"1","status":0},{"account_id":"huobipool.poolv1.near","numerator":10,"number_of_accounts":17,"stake":371.74779999999998,"vote":"0","status":0},{"account_id":"jubi.poolv1.near","numerator":0,"number_of_accounts":10,"stake":335.8125,"vote":"0","status":0},{"account_id":"oraclepool.poolv1.near","numerator":7,"number_of_accounts":25,"stake":291.66800000000001,"vote":"0","status":0},{"account_id":"trillian.poolv1.near","numerator":42,"number_of_accounts":6,"stake":140.0061,"vote":"0","status":0},{"account_id":"artemis.poolv1.near","numerator":100,"number_of_accounts":7,"stake":62.656799999999997,"vote":"0","status":0},{"account_id":"machfund.poolv1.near","numerator":7,"number_of_accounts":2,"stake":58.000500000000002,"vote":"0","status":0},{"account_id":"lowfeevalidation.poolv1.near","numerator":1,"number_of_accounts":2,"stake":52.6004,"vote":"0","status":0},{"account_id":"sweden.poolv1.near","numerator":10,"number_of_accounts":7,"stake":53.326300000000003,"vote":"0","status":0},{"account_id":"okexpool.poolv1.near","numerator":10,"number_of_accounts":5,"stake":33.033000000000001,"vote":"0","status":0},{"account_id":"00agent.poolv1.near","numerator":10,"number_of_accounts":1,"stake":31.000800000000002,"vote":"0","status":0},{"account_id":"iosgvc.poolv1.near","numerator":5,"number_of_accounts":1,"stake":30.006699999999999,"vote":"0","status":0},{"account_id":"dialecticstake.poolv1.near","numerator":9,"number_of_accounts":4,"stake":30.011299999999999,"vote":"0","status":0},{"account_id":"kukulastake1.poolv1.near","numerator":9,"number_of_accounts":2,"stake":30.005099999999999,"vote":"0","status":0},{"account_id":"cypherhunter.poolv1.near","numerator":10,"number_of_accounts":2,"stake":30.000599999999999,"vote":"0","status":0},{"account_id":"bobby.poolv1.near","numerator":10,"number_of_accounts":5,"stake":30.011900000000001,"vote":"0","status":0},{"account_id":"majlovesreg.poolv1.near","numerator":1,"number_of_accounts":15,"stake":30.174299999999999,"vote":"0","status":0},{"account_id":"johnsmith.poolv1.near","numerator":10,"number_of_accounts":2,"stake":30.005199999999999,"vote":"0","status":0},{"account_id":"zpool.poolv1.near","numerator":3,"number_of_accounts":1,"stake":30.0062,"vote":"0","status":0},{"account_id":"swiss-staking.poolv1.near","numerator":0,"number_of_accounts":2,"stake":30.0017,"vote":"0","status":0},{"account_id":"wetez.poolv1.near","numerator":10,"number_of_accounts":0,"stake":30,"vote":"0","status":0},{"account_id":"01stake.poolv1.near","numerator":0,"number_of_accounts":1,"stake":30.0015,"vote":"0","status":0},{"account_id":"anonstake.poolv1.near","numerator":8,"number_of_accounts":1,"stake":30.001999999999999,"vote":"0","status":0},{"account_id":"thepassivetrust.poolv1.near","numerator":10,"number_of_accounts":3,"stake":30.0062,"vote":"0","status":0},{"account_id":"rocknroll.poolv1.near","numerator":5,"number_of_accounts":3,"stake":30.0169,"vote":"0","status":0},{"account_id":"cryptosolutions.poolv1.near","numerator":3,"number_of_accounts":2,"stake":30.013300000000001,"vote":"0","status":0},{"account_id":"easy2stake.poolv1.near","numerator":10,"number_of_accounts":1,"stake":30.000399999999999,"vote":"0","status":0},{"account_id":"bizi.poolv1.near","numerator":5,"number_of_accounts":0,"stake":30,"vote":"0","status":0},{"account_id":"infinite.poolv1.near","numerator":8,"number_of_accounts":1,"stake":30.0016,"vote":"0","status":0},{"account_id":"near4u.poolv1.near","numerator":0,"number_of_accounts":5,"stake":30.007000000000001,"vote":"0","status":0}],"seat_price":"3129250"}
				if (result.data) {
					// this.staking_pools = JSON.parse(result.data).data
					this.staking_pools = result.data
					this.updateStakingStats()
				}
				this.updating_pools = false
			} catch (e) {
				console.log('updateStakingPools Err:', e)
				this.updating_pools = false
				return Promise.reject(e)
			}
		},
		updateStakingStats() {
			let staked = 0
			let stakers = 0
			let pools = 0
			
			for (let pool of this.staking_pools) {
				if (pool.stake && pool.account_id && pool.number_of_accounts) {
					staked += pool.stake
					stakers += pool.number_of_accounts
					pools++
				}
			}
			
			this.total_staked = new Intl.NumberFormat('en-US').format(Math.round(staked))
			this.total_stakers = stakers
			this.total_pools = pools
		},
	}
}
</script>

<style scoped>
.staking-wrapper {
	@apply pt-16
}
.zavodil-tag {
	@apply w-full block mt-16;
	text-align: end;
}
</style>

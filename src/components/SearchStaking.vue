<template>
<div class="staking-wrapper">
	<h4 class="text-headline mx-auto max-w-fit">
		{{total_staked}}N Staked by
	</h4>
	<h4 class="text-headline mx-auto max-w-fit">
		{{total_stakers}} Stakers at the top
	</h4>
	<h4 class="text-headline mx-auto max-w-fit">
		{{total_pools}} pools
	</h4>
	<span class="zavodil-tag mt-8">
		data provided by
		<a href="https://near.zavodil.ru/" class="link">Zavodil</a>
	</span>
</div>
</template>

<script>
export default {
	name: 'SearchStaking',
	data() {
		return {
			updating_pools: false,
			total_staked: 0,
			total_stakers: 0,
			total_pools: 0,
			staking_pools: []
		}
	},
	mounted() {
	 this.updateStakingPools()
	},
	methods: {
		async updateStakingPools() {
			try {
				this.updating_pools = true
				// let result = await fetch('https://near.zavodil.ru/pools_all.txt', {
				// 	mode: 'cors'
				// })
				// console.log('updateStakingPools result', result)
				let result = {"data":[{"account_id":"staked.poolv1.near","numerator":10,"number_of_accounts":1840,"stake":43014502.842699997,"vote":1,"status":1},{"account_id":"bzam6yjpnfnxsdmjf6pw.poolv1.near","numerator":100,"number_of_accounts":307,"stake":23379527.394699998,"vote":0,"status":1},{"account_id":"aurora.pool.near","numerator":99,"number_of_accounts":2557,"stake":21575580.3114,"vote":0,"status":1},{"account_id":"astro-stakers.poolv1.near","numerator":1,"number_of_accounts":5053,"stake":20572323.179699998,"vote":1,"status":1},{"account_id":"bisontrails.poolv1.near","numerator":10,"number_of_accounts":757,"stake":20463073.620499998,"vote":1,"status":1},{"account_id":"dragonfly.poolv1.near","numerator":10,"number_of_accounts":337,"stake":19646455.7399,"vote":0,"status":1},{"account_id":"foundry.poolv1.near","numerator":10,"number_of_accounts":233,"stake":18841155.0154,"vote":0,"status":1},{"account_id":"finoa.poolv1.near","numerator":10,"number_of_accounts":251,"stake":13754401.196900001,"vote":0,"status":1},{"account_id":"blockdaemon.poolv1.near","numerator":5,"number_of_accounts":312,"stake":12558972.9123,"vote":0,"status":1},{"account_id":"epic.poolv1.near","numerator":1,"number_of_accounts":2955,"stake":11581008.407600001,"vote":0,"status":1},{"account_id":"magic.poolv1.near","numerator":5,"number_of_accounts":534,"stake":10496974.0912,"vote":0,"status":1},{"account_id":"rekt.poolv1.near","numerator":1.5,"number_of_accounts":920,"stake":9253354.9367999993,"vote":0,"status":1},{"account_id":"electric.poolv1.near","numerator":10,"number_of_accounts":195,"stake":8105081.1468000002,"vote":0,"status":1},{"account_id":"zavodil.poolv1.near","numerator":1,"number_of_accounts":4245,"stake":8019079.9929,"vote":1,"status":1},{"account_id":"d1.poolv1.near","numerator":5,"number_of_accounts":375,"stake":7251817.9820999997,"vote":0,"status":1},{"account_id":"nearcrowd.poolv1.near","numerator":100,"number_of_accounts":248,"stake":7085709.7341999998,"vote":0,"status":1},{"account_id":"anonymous.poolv1.near","numerator":100,"number_of_accounts":199,"stake":6263483.2391999997,"vote":0,"status":1},{"account_id":"08investinwomen_runbybisontrails.poolv1.near","numerator":5,"number_of_accounts":346,"stake":5859028.6014,"vote":0,"status":1},{"account_id":"dokiacapital.poolv1.near","numerator":10,"number_of_accounts":275,"stake":5846444.5290000001,"vote":1,"status":1},{"account_id":"continue.poolv1.near","numerator":5,"number_of_accounts":333,"stake":5388195.0412999997,"vote":0,"status":1},{"account_id":"legends.poolv1.near","numerator":10,"number_of_accounts":332,"stake":5375691.9008999998,"vote":0,"status":1},{"account_id":"accomplice.poolv1.near","numerator":100,"number_of_accounts":212,"stake":5261417.7955,"vote":0,"status":1},{"account_id":"chorusone.poolv1.near","numerator":8,"number_of_accounts":398,"stake":5247038.7215999998,"vote":1,"status":1},{"account_id":"abl_pool.poolv1.near","numerator":12,"number_of_accounts":167,"stake":5195781.2471000003,"vote":0,"status":1},{"account_id":"future_is_near.poolv1.near","numerator":3,"number_of_accounts":262,"stake":5168322.8828999996,"vote":0,"status":1},{"account_id":"binancenode1.poolv1.near","numerator":5,"number_of_accounts":273,"stake":5082312.8868000004,"vote":0,"status":1},{"account_id":"hb436_pool.poolv1.near","numerator":10,"number_of_accounts":140,"stake":4869554.1778999995,"vote":0,"status":1},{"account_id":"openshards.poolv1.near","numerator":5,"number_of_accounts":1659,"stake":4759468.8295999998,"vote":1,"status":1},{"account_id":"figment.poolv1.near","numerator":10,"number_of_accounts":324,"stake":4662230.2374,"vote":0,"status":1},{"account_id":"ideocolabventures.poolv1.near","numerator":10,"number_of_accounts":162,"stake":4423095.8486000001,"vote":0,"status":1},{"account_id":"buildlinks.poolv1.near","numerator":5,"number_of_accounts":1306,"stake":4352792.6558999997,"vote":1,"status":1},{"account_id":"northernlights.poolv1.near","numerator":8,"number_of_accounts":186,"stake":4350826.6525999997,"vote":0,"status":1},{"account_id":"nearfans.poolv1.near","numerator":5,"number_of_accounts":410,"stake":3822624.6593999998,"vote":0,"status":1},{"account_id":"stakin.poolv1.near","numerator":1,"number_of_accounts":2338,"stake":3815845.5112999999,"vote":1,"status":1},{"account_id":"smart-stake.poolv1.near","numerator":1,"number_of_accounts":1934,"stake":3719241.1531000002,"vote":0,"status":1},{"account_id":"nodeasy.poolv1.near","numerator":3,"number_of_accounts":485,"stake":3532075.3557000002,"vote":1,"status":1},{"account_id":"erm.poolv1.near","numerator":8,"number_of_accounts":160,"stake":3530922.8772,"vote":1,"status":1},{"account_id":"cryptium.poolv1.near","numerator":5,"number_of_accounts":334,"stake":3462071.7381000002,"vote":0,"status":1},{"account_id":"lux.poolv1.near","numerator":5,"number_of_accounts":314,"stake":3301375.8701999998,"vote":1,"status":1},{"account_id":"sharpdarts.poolv1.near","numerator":5,"number_of_accounts":371,"stake":3153485.4171000002,"vote":0,"status":1},{"account_id":"hashquark.poolv1.near","numerator":3,"number_of_accounts":557,"stake":3116076.8382999999,"vote":1,"status":1},{"account_id":"everstake.poolv1.near","numerator":3,"number_of_accounts":1954,"stake":3097250.5205000001,"vote":0,"status":1},{"account_id":"dsrvlabs.poolv1.near","numerator":10,"number_of_accounts":189,"stake":3066738.3843,"vote":1,"status":1},{"account_id":"baziliknear.poolv1.near","numerator":3,"number_of_accounts":418,"stake":2944621.5112000001,"vote":1,"status":1},{"account_id":"stakesabai.poolv1.near","numerator":1,"number_of_accounts":1893,"stake":2867328.3678000001,"vote":1,"status":1},{"account_id":"stardust.poolv1.near","numerator":5,"number_of_accounts":439,"stake":2822422.5148,"vote":1,"status":1},{"account_id":"masternode24.poolv1.near","numerator":1,"number_of_accounts":1858,"stake":2803064.2576000001,"vote":1,"status":1},{"account_id":"lunanova.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":255,"stake":2780699.1486,"vote":1,"status":1},{"account_id":"appload.poolv1.near","numerator":3,"number_of_accounts":1052,"stake":2478344.3961999998,"vote":0,"status":1},{"account_id":"01node.poolv1.near","numerator":3,"number_of_accounts":1860,"stake":2268999.1030000001,"vote":1,"status":1},{"account_id":"fish.poolv1.near","numerator":4,"number_of_accounts":592,"stake":2105907.1724,"vote":0,"status":1},{"account_id":"tottenham_hotspur.poolv1.near","numerator":10,"number_of_accounts":134,"stake":2076163.7664999999,"vote":0,"status":1},{"account_id":"moonlet.poolv1.near","numerator":5,"number_of_accounts":1077,"stake":2033932.7023,"vote":1,"status":1},{"account_id":"jazza.poolv1.near","numerator":4,"number_of_accounts":319,"stake":1810581.4968999999,"vote":1,"status":1},{"account_id":"inotel.poolv1.near","numerator":3,"number_of_accounts":441,"stake":1740368.7464000001,"vote":1,"status":1},{"account_id":"fresh.poolv1.near","numerator":1.8999999999999999,"number_of_accounts":854,"stake":1310949.45,"vote":1,"status":1},{"account_id":"zkv_staketosupportprivacy.poolv1.near","numerator":4,"number_of_accounts":313,"stake":1088532.5382000001,"vote":0,"status":1},{"account_id":"steak.poolv1.near","numerator":4,"number_of_accounts":137,"stake":717604.15300000005,"vote":0,"status":1},{"account_id":"qbit.poolv1.near","numerator":5,"number_of_accounts":40,"stake":555134.03639999998,"vote":0,"status":1},{"account_id":"lionstake.poolv1.near","numerator":5,"number_of_accounts":66,"stake":453554.326,"vote":0,"status":1},{"account_id":"p2p-org.poolv1.near","numerator":0,"number_of_accounts":698,"stake":434075.99459999998,"vote":0,"status":1},{"account_id":"galaxydigital.poolv1.near","numerator":10,"number_of_accounts":99,"stake":412161.6053,"vote":0,"status":1},{"account_id":"kosmos_and_p2p.poolv1.near","numerator":5,"number_of_accounts":21,"stake":373581.2562,"vote":0,"status":1},{"account_id":"ashert.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":19,"stake":369830.42310000001,"vote":0,"status":1},{"account_id":"vortex_live.poolv1.near","numerator":5,"number_of_accounts":47,"stake":360396.28690000001,"vote":0,"status":1},{"account_id":"centurion.poolv1.near","numerator":1,"number_of_accounts":207,"stake":321652.3382,"vote":0,"status":1},{"account_id":"sparkpool.poolv1.near","numerator":5,"number_of_accounts":287,"stake":313499.8015,"vote":1,"status":1},{"account_id":"binancestaking.poolv1.near","numerator":10,"number_of_accounts":945,"stake":248228.93669999999,"vote":0,"status":1},{"account_id":"optimusvalidatornetwork.poolv1.near","numerator":1,"number_of_accounts":197,"stake":245118.95939999999,"vote":0,"status":1},{"account_id":"prophet.poolv1.near","numerator":0,"number_of_accounts":847,"stake":209588.57260000001,"vote":0,"status":1},{"account_id":"near-fans.poolv1.near","numerator":3,"number_of_accounts":238,"stake":206693.2433,"vote":0,"status":1},{"account_id":"pathrocknetwork.poolv1.near","numerator":1,"number_of_accounts":197,"stake":201657.20910000001,"vote":0,"status":1},{"account_id":"dexagon.poolv1.near","numerator":1,"number_of_accounts":209,"stake":199982.65549999999,"vote":0,"status":1},{"account_id":"cryptogarik.poolv1.near","numerator":1,"number_of_accounts":193,"stake":188751.4345,"vote":0,"status":1},{"account_id":"ib.poolv1.near","numerator":3,"number_of_accounts":160,"stake":187222.90299999999,"vote":0,"status":1},{"account_id":"infiniteloop.poolv1.near","numerator":1,"number_of_accounts":163,"stake":181900.60920000001,"vote":0,"status":1},{"account_id":"ledgerbyfigment.poolv1.near","numerator":7.5,"number_of_accounts":22,"stake":174132.92389999999,"vote":0,"status":1},{"account_id":"pandateam.poolv1.near","numerator":1,"number_of_accounts":191,"stake":171978.0001,"vote":0,"status":1},{"account_id":"stakely_io.poolv1.near","numerator":5,"number_of_accounts":90,"stake":169134.24849999999,"vote":0,"status":1},{"account_id":"staking-power.poolv1.near","numerator":5,"number_of_accounts":44,"stake":169111.51579999999,"vote":0,"status":1},{"account_id":"galactic.poolv1.near","numerator":10,"number_of_accounts":46,"stake":156576.24549999999,"vote":0,"status":1},{"account_id":"incrypted.poolv1.near","numerator":3,"number_of_accounts":219,"stake":155107.70129999999,"vote":0,"status":1},{"account_id":"avado.poolv1.near","numerator":5,"number_of_accounts":30,"stake":152355.31789999999,"vote":0,"status":1},{"account_id":"genesislab.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":35,"stake":151812.79860000001,"vote":0,"status":1},{"account_id":"shardlabs.poolv1.near","numerator":5,"number_of_accounts":96,"stake":149463.7635,"vote":0,"status":1},{"account_id":"grassets.poolv1.near","numerator":5,"number_of_accounts":46,"stake":149140.96410000001,"vote":0,"status":1},{"account_id":"inc4.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":28,"stake":145204.8314,"vote":0,"status":1},{"account_id":"lavenderfive.poolv1.near","numerator":5,"number_of_accounts":42,"stake":142181.05790000001,"vote":0,"status":1},{"account_id":"doubletop.poolv1.near","numerator":3,"number_of_accounts":511,"stake":140933.0123,"vote":0,"status":1},{"account_id":"stakesstone.poolv1.near","numerator":5,"number_of_accounts":38,"stake":140881.26269999999,"vote":0,"status":1},{"account_id":"cryptoblossom.poolv1.near","numerator":1,"number_of_accounts":84,"stake":140758.61970000001,"vote":0,"status":1},{"account_id":"4ire.poolv1.near","numerator":5,"number_of_accounts":31,"stake":139499.9847,"vote":0,"status":1},{"account_id":"sicmundus.poolv1.near","numerator":5,"number_of_accounts":61,"stake":139321.13560000001,"vote":0,"status":1},{"account_id":"dariya.poolv1.near","numerator":5,"number_of_accounts":33,"stake":137195.0295,"vote":0,"status":1},{"account_id":"anchikovproduction.poolv1.near","numerator":5,"number_of_accounts":26,"stake":131800.94010000001,"vote":0,"status":1},{"account_id":"bflame.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":13,"stake":107375.35980000001,"vote":0,"status":1},{"account_id":"projecttent.poolv1.near","numerator":5,"number_of_accounts":28,"stake":104441.3937,"vote":0,"status":1},{"account_id":"ni.poolv1.near","numerator":4,"number_of_accounts":23,"stake":104134.6893,"vote":0,"status":1},{"account_id":"chelovek_iz_naroda.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":12,"stake":103388.3064,"vote":0,"status":1},{"account_id":"n0ok.poolv1.near","numerator":7.0000000000000009,"number_of_accounts":12,"stake":103183.14629999999,"vote":0,"status":1},{"account_id":"nc2.poolv1.near","numerator":1,"number_of_accounts":168,"stake":4097142.4994000001,"vote":"0","status":0},{"account_id":"aurora.poolv1.near","numerator":9,"number_of_accounts":10849,"stake":1798452.2041,"vote":"0","status":0},{"account_id":"stakedao_retail.poolv1.near","numerator":7,"number_of_accounts":16,"stake":102243.3631,"vote":"0","status":0},{"account_id":"guli.poolv1.near","numerator":5,"number_of_accounts":11,"stake":100977.13,"vote":"0","status":0},{"account_id":"infstones.poolv1.near","numerator":5,"number_of_accounts":4,"stake":100033.7053,"vote":"0","status":0},{"account_id":"cryptotribe.poolv1.near","numerator":1,"number_of_accounts":151,"stake":40936.465600000003,"vote":"0","status":0},{"account_id":"certusone.poolv1.near","numerator":10,"number_of_accounts":17,"stake":13965.840399999999,"vote":"0","status":0},{"account_id":"audit_one.poolv1.near","numerator":7,"number_of_accounts":234,"stake":12140.5,"vote":"0","status":0},{"account_id":"alex.poolv1.near","numerator":1,"number_of_accounts":12,"stake":1399.7718,"vote":"0","status":0},{"account_id":"near8888.poolv1.near","numerator":5,"number_of_accounts":16,"stake":652.90970000000004,"vote":"1","status":0},{"account_id":"huobipool.poolv1.near","numerator":10,"number_of_accounts":17,"stake":371.74779999999998,"vote":"0","status":0},{"account_id":"jubi.poolv1.near","numerator":0,"number_of_accounts":10,"stake":335.8125,"vote":"0","status":0},{"account_id":"oraclepool.poolv1.near","numerator":7,"number_of_accounts":25,"stake":291.66890000000001,"vote":"0","status":0},{"account_id":"trillian.poolv1.near","numerator":42,"number_of_accounts":6,"stake":140.0061,"vote":"0","status":0},{"account_id":"artemis.poolv1.near","numerator":100,"number_of_accounts":7,"stake":62.656799999999997,"vote":"0","status":0},{"account_id":"machfund.poolv1.near","numerator":7,"number_of_accounts":2,"stake":58.000500000000002,"vote":"0","status":0},{"account_id":"lowfeevalidation.poolv1.near","numerator":1,"number_of_accounts":2,"stake":52.6004,"vote":"0","status":0},{"account_id":"sweden.poolv1.near","numerator":10,"number_of_accounts":7,"stake":53.326300000000003,"vote":"0","status":0},{"account_id":"okexpool.poolv1.near","numerator":10,"number_of_accounts":5,"stake":33.033000000000001,"vote":"0","status":0},{"account_id":"00agent.poolv1.near","numerator":10,"number_of_accounts":1,"stake":31.000800000000002,"vote":"0","status":0},{"account_id":"iosgvc.poolv1.near","numerator":5,"number_of_accounts":1,"stake":30.006699999999999,"vote":"0","status":0},{"account_id":"dialecticstake.poolv1.near","numerator":9,"number_of_accounts":4,"stake":30.011299999999999,"vote":"0","status":0},{"account_id":"kukulastake1.poolv1.near","numerator":9,"number_of_accounts":2,"stake":30.005099999999999,"vote":"0","status":0},{"account_id":"cypherhunter.poolv1.near","numerator":10,"number_of_accounts":2,"stake":30.000599999999999,"vote":"0","status":0},{"account_id":"bobby.poolv1.near","numerator":10,"number_of_accounts":5,"stake":30.011900000000001,"vote":"0","status":0},{"account_id":"majlovesreg.poolv1.near","numerator":1,"number_of_accounts":15,"stake":30.174299999999999,"vote":"0","status":0},{"account_id":"johnsmith.poolv1.near","numerator":10,"number_of_accounts":2,"stake":30.005199999999999,"vote":"0","status":0},{"account_id":"zpool.poolv1.near","numerator":3,"number_of_accounts":1,"stake":30.0062,"vote":"0","status":0},{"account_id":"swiss-staking.poolv1.near","numerator":0,"number_of_accounts":2,"stake":30.0017,"vote":"0","status":0},{"account_id":"wetez.poolv1.near","numerator":10,"number_of_accounts":0,"stake":30,"vote":"0","status":0},{"account_id":"01stake.poolv1.near","numerator":0,"number_of_accounts":1,"stake":30.0015,"vote":"0","status":0},{"account_id":"anonstake.poolv1.near","numerator":8,"number_of_accounts":1,"stake":30.001999999999999,"vote":"0","status":0},{"account_id":"thepassivetrust.poolv1.near","numerator":10,"number_of_accounts":3,"stake":30.0062,"vote":"0","status":0},{"account_id":"rocknroll.poolv1.near","numerator":5,"number_of_accounts":3,"stake":30.0169,"vote":"0","status":0},{"account_id":"cryptosolutions.poolv1.near","numerator":3,"number_of_accounts":2,"stake":30.013300000000001,"vote":"0","status":0},{"account_id":"easy2stake.poolv1.near","numerator":10,"number_of_accounts":1,"stake":30.000399999999999,"vote":"0","status":0},{"account_id":"bizi.poolv1.near","numerator":5,"number_of_accounts":0,"stake":30,"vote":"0","status":0},{"account_id":"infinite.poolv1.near","numerator":8,"number_of_accounts":1,"stake":30.0016,"vote":"0","status":0},{"account_id":"near4u.poolv1.near","numerator":0,"number_of_accounts":5,"stake":30.007000000000001,"vote":"0","status":0}],"seat_price":"3116076"}
				if (result.data) {
					// this.staking_pools = JSON.parse(result.data).data
					this.staking_pools = result.data
					this.updateStakingStats()
				}
				this.updating_pools = false
			} catch (e) {
				console.log('updateStakingPools Err:', e)
				this.updating_pools = false
				return Promise.reject(e)
			}
		},
		updateStakingStats() {
			let staked = 0
			let stakers = 0
			let pools = 0
			
			for (let pool of this.staking_pools) {
				if (pool.stake && pool.account_id && pool.number_of_accounts) {
					staked += pool.stake
					stakers += pool.number_of_accounts
					pools++
				}
			}
			
			this.total_staked = new Intl.NumberFormat('en-US').format(Math.round(staked))
			this.total_stakers = stakers
			this.total_pools = pools
		},
	}
}
</script>

<style scoped>
.staking-wrapper {
	@apply pt-16
}
.zavodil-tag {
	@apply w-full block mt-16;
	text-align: end;
}
</style>
